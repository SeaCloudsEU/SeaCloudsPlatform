tosca_definitions_version: tosca_simple_yaml_1_0_0_wd03
description: WebChat application
imports:
- tosca-normative-types:1.0.0.wd03-SNAPSHOT
topology_template:
  node_templates:
    Chat:
      type: sc_req.Chat
      artifacts:
      - war: http://www.seaclouds.eu/artifacts/chat-webApplication.war
        type: tosca.artifacts.File
      requirements:
      - endpoint: MessageDatabase
      - host: pivotal


    MessageDatabase:
      type: sc_req.MessageDatabase
      artifacts:
      - db_create: http://www.seaclouds.eu/artifacts/create-message-database.sql
        type: tosca.artifacts.File
      properties:
        mysql_version:
          constraints:
          - greater_or_equal: '5.0'
          - less_or_equal: '5.0'
      requirements:
      - host: aws-ec2:us-west-2

    aws-ec2:us-west-2:
      type: seaclouds.nodes.Compute.Amazon
      properties:
        type: compute
        num_cpus: 4
        availability: 0.9995
        cost: 0.928 usd_per_hour
        performance: 795

    pivotal:
      type: seaclouds.nodes.Platform.Pivotal
      properties:
        type: platform
        go_support: true
        java_support: true
        node_support: true
        php_support: true
        python_support: true
        ruby_support: true
        mysql_support: true
        postgresql_support: true
        mongoDB_support: true
        redis_support: true
        riak_support: true
        dataStax_support: true
        neo4j_support: true
        pivotalHD_support: true
        cost: 0.03 $_perGB_per_h
        java_version: [6, 7]

node_types:
  sc_req.Chat:
    derived_from: seaclouds.nodes.webapp.tomcat.TomcatServer
    properties:
      java_support:
        constraints:
        - equal: true
      tomcat_support:
        constraints:
        - equal: true
      java_version:
        constraints:
        - greater_or_equal: '6'
      resource_type:
        constraints:
        - equal: platform
  sc_req.MessageDatabase:
    derived_from: seaclouds.nodes.database.mysql.MySqlNode
    properties:
      disk_size:
        constraints:
        - greater_or_equal: '50'
      resource_type:
        constraints:
        - equal: compute
groups:
  operation_Chat:
    members:
    - Chat
    policies:
    - QoSInfo:
        execution_time: 50 ms
        benchmark_platform: hp_cloud_services.2xl
    - dependencies:
        operation_MessageDatabase: '2'
    - QoSRequirements:
        response_time:
          less_than: 2000.0 ms
        availability:
          greater_than: 0.998
        cost:
          less_or_equal: 200.0 euros_per_month
        workload:
          less_or_equal: 50.0 req_per_min
    - ExpectedQuality: {expectedWorkload: 50.0, expectedAvailability: 0.9994997551225, expectedCost: 190.8, expectedExecutionTime: 0.10079721294968995}  
  operation_MessageDatabase:
    members:
    - MessageDatabase
    policies:
    - QoSInfo:
        execution_time: 30 ms
        benchmark_platform: hp_cloud_services.2xl
    - dependencies: {}
